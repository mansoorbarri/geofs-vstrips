// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum FlightStatus {
  delivery
  ground
  tower
  departure
  approach
  control
}

model flights {
  id               String          @id @default(uuid()) @db.Uuid
  airport          String          @db.VarChar(4)
  callsign         String          @db.VarChar(7)
  discord_username String?         @db.VarChar(32)
  geofs_callsign   String?         @db.VarChar(24)
  aircraft_type    String          @db.VarChar(5)
  departure        String          @db.VarChar(4)
  departure_time   String          @db.VarChar(4)
  arrival          String          @db.VarChar(4)
  altitude         String          @db.VarChar(5)
  speed            String          @db.VarChar(4)
  status           FlightStatus
  notes            String          @db.Text
  created_at       DateTime        @default(now()) @db.Timestamptz(6)
  updated_at       DateTime        @updatedAt @db.Timestamptz(6)

  history  flight_history[]

  @@map("flights")
}

model flight_history {
  id           String    @id @default(uuid()) @db.Uuid
  flight_id    String    @db.Uuid
  old_status   String    @db.VarChar(255)
  new_status   String    @db.VarChar(255)
  changed_at   DateTime  @default(now()) @db.Timestamptz(6)
  changed_by   String?   @db.VarChar(255)

  flight  flights @relation(fields: [flight_id], references: [id])

  @@map("flight_history")
}